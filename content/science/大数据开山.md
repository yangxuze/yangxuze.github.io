+++

title = "大数据开山"

subTitle = "谷歌三驾马车"

toc = true

tocNum = false

linkTitle = "大数据开山"
date = "2025-07-08T22:11:06+08:00"
tags = ["大数据", "漫谈",  "谷歌"]
displayModifiedDate = false
align = "justify"

+++

谷歌的“三驾马车”开启了大数据时代，并为我们指明了大数据的发展方向。

谷歌文件系统第一次公开发表的论文是在 2003 年，MapReduce 公开发表的时间是 2004 年，而 BigTable 则公开发表于 2006 年。

谷歌的传统做法向来是先内部使用，等到下一代产品开发得差不多了，再发布这一代的产品。因此，谷歌的“三驾马车”在内部使用的时间更早。

这“三驾马车”，主要是为谷歌的核心搜索业务服务的。作为全球最大的搜索引擎，谷歌需要存储整个互联网的内容，并且要在这个内容的基础上构建倒排索引，这些都是基于“三驾马车”来实现的。

倒排索引是对互联网内容的一种索引方法，是指从搜索词到对应的互联网文档的索引方法。 用户可以通过搜索词去搜索互联网，返回的则是和搜索词相关的文档。之所以称为倒排索引，是因为文档到文档里面的词是顺序的，而从文档里面的词到文档是逆序的。

为了构建倒排索引，谷歌首先需要存储整个互联网的内容，并存储构建倒排索引所需的空间。而在当时的技术条件下，世界上是没有现成的产品可以实现这种倒排索引。所以，谷歌发明了谷歌文件系统，一个基于大量的廉价个人计算机的海量存储系统，它可以轻松地存储整个互联网的内容。

MapReduce 则是谷歌构建第一代倒排索引的基础，它可以大规模并行地处理整个互联网上的所有文档，这是相当令人吃惊的。但是，这个索引构建方法有一个天然的缺陷：每次重新构建索引的时候都需要把整个索引全部推翻重来，而无法做到增量更新。而即使以谷歌的计算能力，重新构建一次索引也需要若干天的时间。这种做法最大的弊端是，新的突然更新的消息无法迅速融入到搜索引擎里。

而互联网内容变化的特点是，热点网站变化非常快，很多非热点网站却可能几个月如一日地没有内容更新。为了让索引的构建可以做到增量更新，即只更新有变化的网站，谷歌发明了 BigTable。

**BigTable 是一个键值存储系统**。 它可以存储一个主键的不同时期的多个版本的值，是谷歌代号为“咖啡因”的最新一代倒排索引引擎的核心。

在“咖啡因”构建倒排索引引擎里，因为 BigTable 这个键值系统的存在，互联网地址可以作为某个 BigTable 的主键使用，因此谷歌不必再把所有互联网地址全部推倒来重新构建索引，而只需要更新那些值已经发生变化的互联网地址。这样一来，网站上出现的新闻可以以秒级的速度被用户搜索到了。

公允地讲，虽然谷歌扮演了大数据先驱者的角色，但是这个概念并不是它提出来的，而谷歌也从未真正通过给用户提供大数据分析平台服务的方式赚到钱，甚至在后来的 Hadoop 大数据开源社区里也毫无影响力。

除了谷歌，当时有众多互联网企业在诞生和发展，比如 Facebook、LinkedIn，比如当时还如日中天的雅虎，又比如打算和谷歌在搜索领域竞争的微软。当这些公司意识到互联网前进的方向就是那个炙手可热的“大数据”概念，和这个概念下需要的海量存储和数据处理系统时，它们就需要面临艰难的抉择了。

有些公司，比如微软，对自己充满信心，决定像谷歌一样自己构建一套系统。有关微软这套系统的故事（todo），我们会在后续的文章里继续讲解。有些公司，比如**雅虎和 Facebook**，觉得凭借一己之力很难做到，于是开始抱团取暖，**共同构建了后来闻名于世的 Hadoop 生态圈**。

凭心而论，在很长一段时间里，Hadoop 和谷歌内部的系统相比非常落后和不堪一击。然而，Hadoop 这个毫无先进性可言的系统，凭借着人多力量大，竟也慢慢成长起来了。 这种成长包括两方面：

* 一方面是，Hadoop 的生态圈越来越大，用的人越来越多。越来越多的用户也在不断刺激着 Hadoop 的创新，这些创新导致 Hadoop 和谷歌的内部技术渐行渐远；
* 另外一方面是，Hadoop 因为用户多，成为了事实上的标准。

### 说明

#### 倒排索引

主要用于信息检索领域。它的核心思想是建立“关键字”到“文档”的映射，而非文档到关键字的映射，这种结构能快速定位包含特定关键词的文档。

用户可以通过搜索词去搜索互联网，返回的则是和搜索词相关的文档。之所以称为倒排索引，是因为文档到文档里面的词是顺序的，而从文档里面的词到文档是逆序的。

例子：

假设有三个文档：

- 文档1: `今天天气很好`
- 文档2: `今天吃饭了吗`
- 文档3: `天气预报说今天有雨`

则构建出的倒排索引如下：

| 关键词 | 出现的文档编号 |
| ------ | -------------- |
| 今天   | 1, 2, 3        |
| 天气   | 1, 3           |
| 很好   | 1              |
| 吃饭   | 2              |
| 了吗   | 2              |
| 预报   | 3              |
| 说     | 3              |
| 有雨   | 3              |

当用户搜索关键词 `天气` 时，可以迅速通过倒排索引定位到：

- 文档1 (`今天天气很好`)
- 文档3 (`天气预报说今天有雨`)

相比遍历所有文档查找关键词，倒排索引的查询速度明显更快，因此被广泛应用于搜索引擎、数据库全文检索等场景。

> 参考 https://time.geekbang.org/column/article/7140

